<!DOCTYPE html>
<html>
<head>
    <title>Monaco Editor</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #1e1e1e;
            font-family: 'Consolas', 'Monaco', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        #sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background: #252526;
            border-right: 1px solid #3c3c3c;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        #sidebar.hidden {
            transform: translateX(-250px);
        }
        #sidebar-header {
            padding: 15px;
            border-bottom: 1px solid #3c3c3c;
            color: #cccccc;
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        #sidebar-files {
            flex: 1;
            overflow-y: auto;
        }
        .sidebar-file {
            padding: 10px 15px;
            color: #cccccc;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            border-bottom: 1px solid #3c3c3c;
        }
        .sidebar-file:hover {
            background: #2d2d30;
        }
        .sidebar-file.active {
            background: #1e1e1e;
            color: #fff;
            border-left: 3px solid #007acc;
        }
        .sidebar-file-name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .sidebar-file-close {
            margin-left: 10px;
            opacity: 0.6;
            font-weight: bold;
            font-size: 16px;
        }
        .sidebar-file-close:hover {
            opacity: 1;
            color: #e06c75;
        }
        #sidebar-new {
            padding: 12px 15px;
            color: #4EC9B0;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            text-align: center;
            border-top: 1px solid #3c3c3c;
            background: #1e1e1e;
        }
        #sidebar-new:hover {
            background: #2d2d30;
        }
        #sidebar-toggle {
            position: fixed;
            bottom: 10px;
            left: 10px;
            z-index: 1001;
            background: #252526;
            color: #cccccc;
            border: 1px solid #3c3c3c;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 2px;
            font-size: 13px;
            transition: left 0.3s ease;
        }
        #sidebar-toggle:hover {
            background: #2d2d30;
        }
        #sidebar-toggle.sidebar-hidden {
            left: 10px;
        }
        #sidebar-toggle.sidebar-visible {
            left: 260px;
        }
        .selector {
            position: fixed;
            bottom: 10px;
            z-index: 1000;
            background: #252526;
            color: #cccccc;
            border: 1px solid #3c3c3c;
            padding: 8px 12px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            cursor: pointer;
            border-radius: 2px;
        }
        .selector:hover {
            background: #2d2d30;
        }
        #language-selector {
            right: 190px;
        }
        #theme-selector {
            right: 20px;
        }
        #container {
            flex: 1;
            width: 100%;
            margin-left: 250px;
            transition: margin-left 0.3s ease;
        }
        #container.sidebar-hidden {
            margin-left: 0;
        }
    </style>
</head>
<body>
    <button id="sidebar-toggle">☰</button>
    <div id="sidebar">
        <div id="sidebar-header">Files</div>
        <div id="sidebar-files"></div>
        <div id="sidebar-new">+ New File</div>
    </div>
    <select id="language-selector" class="selector">
        <option value="plaintext">Plain Text</option>
        <option value="cpp">C++</option>
        <option value="c">C</option>
        <option value="javascript">JavaScript</option>
        <option value="typescript">TypeScript</option>
        <option value="python">Python</option>
        <option value="java">Java</option>
        <option value="csharp">C#</option>
        <option value="go">Go</option>
        <option value="rust">Rust</option>
        <option value="html">HTML</option>
        <option value="css">CSS</option>
        <option value="json">JSON</option>
        <option value="markdown">Markdown</option>
        <option value="sql">SQL</option>
        <option value="php">PHP</option>
    </select>
    <select id="theme-selector" class="selector">
        <option value="one-dark-black" selected>VS Dark Black</option>
        <option value="vs-dark">VS Code Dark</option>
        <option value="vs">VS Code Light</option>
    </select>
    <div id="container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    <script>
        require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' }});

        require(['vs/editor/editor.main'], function() {
            // Define VS Dark Black theme
            monaco.editor.defineTheme('one-dark-black', {
                base: 'vs-dark',
                inherit: true,
                rules: [],
                colors: {
                    'editor.background': '#000000',
                }
            });

            // File management
            var files = {};
            var currentFileId = null;
            var fileCounter = 0;
            var editor = null;
            var saveTimeout = null;

            // Initialize editor
            editor = monaco.editor.create(document.getElementById('container'), {
                value: '',
                language: 'cpp',
                theme: 'one-dark-black',
                fontSize: 16,
                tabSize: 2,
                insertSpaces: true,
                autoClosingBrackets: 'always',
                autoClosingQuotes: 'always',
                formatOnType: true,
                formatOnPaste: true,
                renderLineHighlight: 'none',
                quickSuggestions: false,
                suggestOnTriggerCharacters: false,
                acceptSuggestionOnEnter: 'off',
                tabCompletion: 'off',
                wordBasedSuggestions: false,
                parameterHints: { enabled: false },
                minimap: { enabled: false },
                scrollbar: {
                    verticalScrollbarSize: 10,
                    horizontalScrollbarSize: 10
                }
            });

            // Load theme
            var savedTheme = localStorage.getItem('editorTheme') || 'one-dark-black';
            monaco.editor.setTheme(savedTheme);
            document.getElementById('theme-selector').value = savedTheme;

            // Load files from localStorage
            function loadFiles() {
                var savedFiles = localStorage.getItem('files');
                var savedCurrentId = localStorage.getItem('currentFileId');

                if (savedFiles) {
                    files = JSON.parse(savedFiles);
                    fileCounter = parseInt(localStorage.getItem('fileCounter')) || Object.keys(files).length;
                }

                // If no files, create a default one
                if (Object.keys(files).length === 0) {
                    createNewFile();
                } else {
                    currentFileId = savedCurrentId || Object.keys(files)[0];
                    renderTabs();
                    loadFile(currentFileId);
                }
            }

            // Save files to localStorage
            function saveFiles() {
                localStorage.setItem('files', JSON.stringify(files));
                localStorage.setItem('currentFileId', currentFileId);
                localStorage.setItem('fileCounter', fileCounter.toString());
            }

            // Save current file content
            function saveCurrentFile() {
                if (currentFileId && files[currentFileId]) {
                    files[currentFileId].content = editor.getValue();
                    files[currentFileId].language = editor.getModel().getLanguageId();
                    saveFiles();
                }
            }

            // Auto-save
            editor.onDidChangeModelContent(function() {
                clearTimeout(saveTimeout);
                saveTimeout = setTimeout(saveCurrentFile, 500);
            });

            // Create new file
            function createNewFile() {
                fileCounter++;
                var fileId = 'file-' + fileCounter;
                files[fileId] = {
                    name: 'untitled-' + fileCounter + '.txt',
                    content: '',
                    language: 'plaintext'
                };
                currentFileId = fileId;
                renderTabs();
                loadFile(fileId);
                saveFiles();
            }

            // Switch to file
            function switchToFile(fileId) {
                if (fileId === currentFileId) return;
                saveCurrentFile();
                currentFileId = fileId;
                renderTabs();
                loadFile(fileId);
                saveFiles();
            }

            // Load file into editor
            function loadFile(fileId) {
                if (!files[fileId]) return;
                var file = files[fileId];
                editor.setValue(file.content);
                monaco.editor.setModelLanguage(editor.getModel(), file.language);
                document.getElementById('language-selector').value = file.language;
            }

            // Close file
            function closeFile(fileId) {
                if (Object.keys(files).length === 1) {
                    alert('Cannot close the last file');
                    return;
                }

                delete files[fileId];

                // Switch to another file
                if (currentFileId === fileId) {
                    currentFileId = Object.keys(files)[0];
                    loadFile(currentFileId);
                }

                renderTabs();
                saveFiles();
            }

            // Rename file
            function renameFile(fileId) {
                var file = files[fileId];
                var newName = prompt('Enter new name:', file.name);
                if (newName && newName.trim()) {
                    file.name = newName.trim();
                    renderTabs();
                    saveFiles();
                }
            }

            // Render file list in sidebar
            function renderTabs() {
                var sidebarFiles = document.getElementById('sidebar-files');
                sidebarFiles.innerHTML = '';

                // Add file items
                Object.keys(files).forEach(function(fileId) {
                    var file = files[fileId];
                    var item = document.createElement('div');
                    item.className = 'sidebar-file' + (fileId === currentFileId ? ' active' : '');

                    var nameSpan = document.createElement('span');
                    nameSpan.className = 'sidebar-file-name';
                    nameSpan.textContent = file.name;
                    nameSpan.addEventListener('click', function() {
                        switchToFile(fileId);
                    });
                    nameSpan.addEventListener('dblclick', function() {
                        renameFile(fileId);
                    });

                    var closeSpan = document.createElement('span');
                    closeSpan.className = 'sidebar-file-close';
                    closeSpan.textContent = '×';
                    closeSpan.addEventListener('click', function(e) {
                        e.stopPropagation();
                        closeFile(fileId);
                    });

                    item.appendChild(nameSpan);
                    item.appendChild(closeSpan);
                    sidebarFiles.appendChild(item);
                });
            }

            // Toggle sidebar
            var sidebarVisible = localStorage.getItem('sidebarVisible') !== 'false';
            function toggleSidebar() {
                sidebarVisible = !sidebarVisible;
                var sidebar = document.getElementById('sidebar');
                var container = document.getElementById('container');
                var toggle = document.getElementById('sidebar-toggle');

                if (sidebarVisible) {
                    sidebar.classList.remove('hidden');
                    container.classList.remove('sidebar-hidden');
                    toggle.classList.remove('sidebar-hidden');
                    toggle.classList.add('sidebar-visible');
                } else {
                    sidebar.classList.add('hidden');
                    container.classList.add('sidebar-hidden');
                    toggle.classList.remove('sidebar-visible');
                    toggle.classList.add('sidebar-hidden');
                }

                localStorage.setItem('sidebarVisible', sidebarVisible);
                editor.layout();
            }

            // Initialize sidebar state
            if (!sidebarVisible) {
                document.getElementById('sidebar').classList.add('hidden');
                document.getElementById('container').classList.add('sidebar-hidden');
                document.getElementById('sidebar-toggle').classList.add('sidebar-hidden');
            } else {
                document.getElementById('sidebar-toggle').classList.add('sidebar-visible');
            }

            // Sidebar toggle button
            document.getElementById('sidebar-toggle').addEventListener('click', toggleSidebar);

            // New file button
            document.getElementById('sidebar-new').addEventListener('click', function() {
                createNewFile();
            });

            // Language switcher
            document.getElementById('language-selector').addEventListener('change', function() {
                monaco.editor.setModelLanguage(editor.getModel(), this.value);
                if (currentFileId && files[currentFileId]) {
                    files[currentFileId].language = this.value;
                    saveFiles();
                }
            });

            // Theme switcher
            document.getElementById('theme-selector').addEventListener('change', function() {
                monaco.editor.setTheme(this.value);
                localStorage.setItem('editorTheme', this.value);
            });

            // Auto-resize
            window.addEventListener('resize', function() {
                editor.layout();
            });

            // Initialize
            loadFiles();
        });
    </script>
</body>
</html>
